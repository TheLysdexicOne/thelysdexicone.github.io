(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21],{4494:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>x});var t=s(4568),l=s(7620),a=s(462),i=s(185),n=s(6827);function o(e){let{iconId:r,className:s="h-4 w-4"}=e;return(0,t.jsx)("svg",{className:s,viewBox:"0 0 16 16",style:{imageRendering:"pixelated"},children:(0,t.jsx)("use",{href:"".concat((0,n.W)("/images/stats/stat_icons.svg"),"#").concat(r)})})}var d=s(2635),c=s(8459);function g(e){var r;let{building:s,disableMobileExpand:n=!1,isGridExpanded:g=!1}=e,[x,h]=(0,l.useState)(1),[p,m]=(0,l.useState)(!1),u=(null==(r=s.propertiesByLevel.find(e=>e.Level===x))?void 0:r.Properties)||{};return(0,t.jsxs)("div",{className:"overflow-hidden rounded-lg border-2 bg-body shadow-md transition-all ".concat(g?"border-highlight":"border-primary hover:border-highlight"),children:[(0,t.jsx)("button",{onClick:()=>!n&&m(!p),className:"w-full p-2 text-left sm:p-4 ".concat(n?"cursor-default bg-card-header sm:cursor-default":p?"bg-card-header":"bg-secondary sm:cursor-default sm:bg-card-header"),children:(0,t.jsxs)("div",{className:"grid h-16 grid-cols-[auto_1fr_auto] items-center gap-3 sm:gap-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(i.A,{slug:s.slug,name:s.name,className:"h-16 w-16"})}),(0,t.jsx)("div",{className:"min-w-0",children:(0,t.jsx)("h3",{className:"font-pixel text-2xl tracking-wider text-primary sm:text-2xl md:text-4xl",children:s.name})}),!n&&(0,t.jsx)("div",{className:"flex-shrink-0 sm:hidden",children:(0,t.jsx)(d.gc,{icon:p?c.w2A:c.Jt$,className:"h-5 w-5 text-primary"})})]})}),(0,t.jsxs)("div",{className:"".concat(n||p?"block":"hidden"," border-t-2 border-primary p-3 sm:block sm:p-4"),children:[(0,t.jsxs)("div",{className:"mb-3 flex flex-wrap gap-1 sm:gap-2",children:[(0,t.jsx)("span",{className:"rounded border-2 border-highlight bg-primary px-2 py-1 text-base font-semibold text-secondary sm:text-lg",children:s.category.replace(/^k/,"")}),(0,t.jsx)("span",{className:"rounded border-2 border-highlight bg-primary px-2 py-1 text-base font-semibold text-secondary sm:text-lg",children:s.subCategory.replace(/^k/,"").replace(/([A-Z])/g," $1").trim()})]}),(0,t.jsx)("div",{className:"mb-3 flex gap-2 overflow-x-auto",children:Array.from({length:s.numLevels},(e,r)=>r+1).map(e=>(0,t.jsxs)("button",{onClick:()=>h(e),className:"flex-shrink-0 rounded-lg px-3 py-2 text-lg tracking-wider transition-colors sm:text-xl ".concat(x===e?"bg-highlight text-primary":"card-text-box"),children:["Level ",e]},e))}),(0,t.jsx)("div",{className:"mb-3 rounded-lg bg-primary p-3 sm:p-4",children:(0,t.jsx)("p",{className:"text-justify text-lg leading-relaxed text-secondary sm:text-lg",children:(()=>{let e,r=[],l=0,a=/\{(\[.*?\])\}|<color=#\w+>|<\/color>/g;for(;null!==(e=a.exec(s.description));){if(e.index>l&&r.push(s.description.substring(l,e.index)),"<color=#FFFF00>"===e[0]);else if("</color>"===e[0]);else if(e[1]){let s=e[1].replace(/[\[\]]/g,"");if("icon"===s){let l=u[s];l&&["dexterity_icon","endurance_icon","intelligence_icon","leadership_icon","speed_icon","strength_icon"].includes(l)&&r.push((0,t.jsx)(o,{iconId:l,className:"inline-block h-5 w-5"},e.index))}else{let l=u[s];void 0!==l?r.push((0,t.jsx)("span",{className:"text-highlight font-bold",children:String(l)},e.index)):r.push(e[0])}}l=a.lastIndex}return l<s.description.length&&r.push(s.description.substring(l)),r})()})}),(0,t.jsxs)("div",{className:"space-y-1 text-base text-secondary sm:text-base",children:[(0,t.jsxs)("div",{className:"rounded-lg bg-primary p-2 sm:p-3",children:[(0,t.jsx)("strong",{className:"text-primary",children:"Build Cost:"})," ",(0,a.HU)(s.buildCost)]}),s.numLevels>1&&(0,t.jsxs)("div",{className:"rounded-lg bg-primary p-2 sm:p-3",children:[(0,t.jsx)("strong",{className:"text-primary",children:"Base Upgrade Cost:"})," ",(0,a.HU)(s.baseUpgradeCost)]})]})]})]})}function x(){let[e,r]=(0,l.useState)("list"),[s,n]=(0,l.useState)("all"),[o,x]=(0,l.useState)("all"),[h,p]=(0,l.useState)("name"),[m,u]=(0,l.useState)(""),[b,y]=(0,l.useState)(!1),[f,v]=(0,l.useState)(null),[j,w]=(0,l.useState)(!1),[N,C]=(0,l.useState)(2),k=(0,l.useRef)({}),S=(0,a.LK)(),L=(0,l.useMemo)(()=>Array.from(new Set(S.map(e=>e.category))).sort(),[S]),_=(0,l.useMemo)(()=>Array.from(new Set(S.filter(e=>"all"===s||e.category===s).map(e=>e.subCategory))).sort(),[S,s]);(0,l.useEffect)(()=>{{let e=localStorage.getItem("buildings-view-type");("list"===e||"grid"===e)&&r(e),w(!0)}},[]),(0,l.useEffect)(()=>{j&&localStorage.setItem("buildings-view-type",e)},[e,j]),(0,l.useEffect)(()=>{if(f&&1){let e=k.current[f];e&&window.innerWidth<1024&&setTimeout(()=>{let r=e.getBoundingClientRect().top+window.pageYOffset-88;window.scrollTo({top:r,behavior:"smooth"})},100)}},[f]),(0,l.useEffect)(()=>{let e=()=>{{let e=window.innerWidth;e>=1280?C(10):e>=1024?C(8):e>=768?C(6):e>=640?C(5):C(4)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let E=(0,l.useMemo)(()=>{let e=S;if("all"!==s&&(e=e.filter(e=>e.category===s)),"all"!==o&&(e=e.filter(e=>e.subCategory===o)),m){let r=m.toLowerCase().replace(/\s+/g,"");e=e.filter(e=>e.name.toLowerCase().replace(/\s+/g,"").includes(r)||e.slug.toLowerCase().replace(/\s+/g,"").includes(r)||e.description.toLowerCase().replace(/\s+/g,"").includes(r)||e.shortDescription.toLowerCase().replace(/\s+/g,"").includes(r))}return"category"===h?[...e].sort((e,r)=>e.category!==r.category?e.category.localeCompare(r.category):e.subCategory!==r.subCategory?e.subCategory.localeCompare(r.subCategory):e.name.localeCompare(r.name)):[...e].sort((e,r)=>e.name.localeCompare(r.name))},[S,s,o,h,m]);return j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"card-primary my-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>r("list"),className:"flex-1 rounded-lg px-4 py-2 font-pixel text-2xl tracking-wider transition-colors sm:text-4xl ".concat("list"===e?"bg-btn-primary-highlight text-primary":"card-text-box"),children:"List View"}),(0,t.jsx)("button",{onClick:()=>r("grid"),className:"flex-1 rounded-lg px-4 py-2 font-pixel text-2xl tracking-wider transition-colors sm:text-4xl ".concat("grid"===e?"bg-btn-primary-highlight text-primary":"card-text-box"),children:"Grid View"})]}),(0,t.jsxs)("button",{onClick:()=>y(!b),className:"flex w-full items-center justify-between rounded-lg border-2 border-primary bg-primary px-4 py-2 text-base tracking-wider text-primary transition-colors hover:border-highlight sm:text-lg lg:hidden",children:[(0,t.jsx)("span",{children:"Search & Filters"}),(0,t.jsx)(d.gc,{icon:b?c.w2A:c.Jt$,className:"h-4 w-4"})]}),(0,t.jsxs)("div",{className:"space-y-3 ".concat(b?"block":"hidden"," lg:block"),children:[(0,t.jsx)("input",{type:"text",placeholder:"Search buildings...",value:m,onChange:e=>u(e.target.value),className:"w-full rounded-lg border-2 border-primary bg-primary px-4 py-2 text-base text-primary placeholder:text-primary/50 focus:border-highlight focus:ring-0 sm:text-lg"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)("select",{value:s,onChange:e=>{n(e.target.value),x("all")},className:"w-full cursor-pointer rounded-lg border-2 border-primary bg-primary px-4 py-2 text-base tracking-wider text-primary focus:border-highlight focus:ring-0 sm:text-lg",children:[(0,t.jsx)("option",{value:"all",children:"All Categories"}),L.map(e=>(0,t.jsx)("option",{value:e,children:e.replace(/^k/,"")},e))]}),(0,t.jsxs)("select",{value:o,onChange:e=>x(e.target.value),className:"w-full cursor-pointer rounded-lg border-2 border-primary bg-primary px-4 py-2 text-base tracking-wider text-primary focus:border-highlight focus:ring-0 sm:text-lg",children:[(0,t.jsx)("option",{value:"all",children:"All Types"}),_.map(e=>(0,t.jsx)("option",{value:e,children:e.replace(/^k/,"").replace(/([A-Z])/g," $1").trim()},e))]}),(0,t.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full cursor-pointer rounded-lg border-2 border-primary bg-primary px-4 py-2 text-base tracking-wider text-primary focus:border-highlight focus:ring-0 sm:text-lg",children:[(0,t.jsx)("option",{value:"name",children:"Sort: Alphabetical"}),(0,t.jsx)("option",{value:"category",children:"Sort: Category"})]})]})]})]}),m&&(0,t.jsxs)("div",{className:"mb-3 text-center font-pixel text-sm tracking-wider text-secondary sm:text-base",children:["Found ",E.length," building",1!==E.length?"s":""]}),"list"===e?(0,t.jsx)("div",{className:"space-y-4 px-2 py-2",children:E.map(e=>(0,t.jsx)(g,{building:e},e.id))}):(0,t.jsx)("div",{className:"space-y-3 overflow-visible",children:(()=>{let e=f?E.findIndex(e=>e.id===f):-1,r=e>=0?Math.floor(e/N)*N+N:-1,s=[];if(E.forEach((l,a)=>{let n=f===l.id,o=a%N;if(s.push((0,t.jsxs)("div",{ref:e=>{k.current[l.id]=e},className:n?"relative":"",children:[(0,t.jsx)("button",{onClick:()=>v(n?null:l.id),className:"z-50 flex aspect-square h-full w-full items-center justify-center rounded-lg border-2 p-1 ".concat(n?"rounded-b-none border-highlight border-b-transparent bg-card-header shadow-lg":"border-primary bg-body hover:border-highlight hover:bg-card-header"),children:(0,t.jsx)(i.A,{slug:l.slug,name:l.name,className:"h-full w-full"})}),n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"pointer-events-none absolute left-0 right-0 h-5 w-full -translate-y-[9px] border-x-2 border-b-2 border-highlight border-b-transparent bg-card-header"}),o===N-1&&(0,t.jsx)("div",{className:"pointer-events-none absolute right-0 h-3 w-1/2 translate-y-[2px] border-r-2 border-highlight bg-card-header"}),0===o&&(0,t.jsx)("div",{className:"pointer-events-none absolute left-0 h-3 w-1/2 translate-y-[2px] border-l-2 border-highlight bg-card-header"})]})]},l.id)),r>=0&&a===r-1){let r=E[e];s.push((0,t.jsx)("div",{className:"col-span-full",children:(0,t.jsx)(g,{building:r,disableMobileExpand:!0,isGridExpanded:!0})},"expanded-".concat(r.id)))}}),e>=0&&r>E.length){let r=E[e];s.push((0,t.jsx)("div",{className:"col-span-full",children:(0,t.jsx)(g,{building:r,disableMobileExpand:!0,isGridExpanded:!0})},"expanded-".concat(r.id)))}return(0,t.jsx)("div",{className:"grid gap-2 overflow-visible",style:{gridTemplateColumns:"repeat(".concat(N,", minmax(0, 1fr))"),gridAutoRows:"auto"},children:s})})()}),0===E.length&&(0,t.jsx)("div",{className:"card-text-box py-8",children:"No buildings found matching your criteria."})]}):(0,t.jsx)("div",{className:"flex min-h-[200px] items-center justify-center",children:(0,t.jsx)("div",{className:"font-pixel text-lg tracking-wider text-secondary",children:"Loading..."})})}},6333:(e,r,s)=>{Promise.resolve().then(s.bind(s,4494))}},e=>{e.O(0,[63,635,773,566,587,902,358],()=>e(e.s=6333)),_N_E=e.O()}]);