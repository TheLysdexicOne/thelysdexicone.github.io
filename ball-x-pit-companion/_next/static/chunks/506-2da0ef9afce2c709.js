"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[506],{6506:(e,t,a)=>{a.d(t,{t:()=>y});var r=a(7620),i=a(9429);let s="ball-x-pit-active-slot",l=e=>"ball-x-pit-save-".concat(e),o="progress-data-updated";function n(){window.dispatchEvent(new CustomEvent(o))}function c(){let e=(0,i.w)();return{version:1,lastUpdated:new Date().toISOString(),characters:e.map((e,t)=>({characterId:e.id,customIndex:t,levelCompletions:[]}))}}function d(){try{let e=localStorage.getItem(s),t=e?parseInt(e,10):1;return t>=1&&t<=3?t:1}catch(e){return 1}}function g(e){try{let t=localStorage.getItem(l(e));if(!t)return{characterProgress:c(),lastDifficulty:"base",lastTier:1,lastModified:Date.now(),name:"Save ".concat(e)};let a=JSON.parse(t),r=function(e){if(e.heroProgress&&!e.characterProgress){let t=e.heroProgress;return{characterProgress:{version:t.version||1,lastUpdated:t.lastUpdated||new Date().toISOString(),characters:(t.heroes||[]).map(e=>({characterId:e.heroId,customIndex:e.customIndex,levelCompletions:e.levelCompletions||[]}))},lastDifficulty:e.lastDifficulty||"base",lastTier:e.lastTier||1,lastModified:e.lastModified||Date.now(),name:e.name||"Save ".concat(1)}}return e}(a);return a.heroProgress&&!a.characterProgress&&(p(e,r),console.log("Migrated save slot ".concat(e," from heroProgress to characterProgress"))),r}catch(t){return console.error("Failed to load save slot ".concat(e,":"),t),{characterProgress:c(),lastDifficulty:"base",lastTier:1,lastModified:Date.now(),name:"Save ".concat(e)}}}function p(e,t){try{let a={...t,lastModified:Date.now()};localStorage.setItem(l(e),JSON.stringify(a))}catch(t){console.error("Failed to save slot ".concat(e,":"),t)}}function h(e,t){p(e,t),n()}function y(){(0,r.useEffect)(()=>{!function(){try{if(localStorage.getItem(l(1)))return;let e=localStorage.getItem("ball-x-pit-progress");if(!e)return;let t=JSON.parse(e),a=localStorage.getItem("currentDifficulty")||"base",r=parseInt(localStorage.getItem("currentFastTier")||"0",10),i={characterProgress:t.heroes?{version:t.version||1,lastUpdated:t.lastUpdated||new Date().toISOString(),characters:(t.heroes||[]).map(e=>({characterId:e.heroId,customIndex:e.customIndex,levelCompletions:e.levelCompletions||[]}))}:t,lastDifficulty:a,lastTier:r,lastModified:Date.now(),name:"Save 1"};localStorage.setItem(l(1),JSON.stringify(i)),localStorage.setItem(s,"1"),console.log("Migrated legacy data to save slot 1")}catch(e){console.error("Failed to migrate legacy data:",e)}}()},[]);let[e,t]=(0,r.useState)(()=>d()),[a,i]=(0,r.useState)(()=>g(e)),[y,u]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=()=>{let e=d();t(e),i(g(e)),u(e=>e+1)};return window.addEventListener(o,e),()=>window.removeEventListener(o,e)},[]);let S=(0,r.useCallback)(()=>[...a.characterProgress.characters].sort((e,t)=>e.customIndex-t.customIndex),[a.characterProgress.characters]);return(0,r.useCallback)(()=>a.lastDifficulty,[a.lastDifficulty]),(0,r.useCallback)(()=>a.lastTier,[a.lastTier]),{progressData:a.characterProgress,currentDifficulty:a.lastDifficulty,currentTier:a.lastTier,activeSlot:e,setCurrentDifficulty:t=>{let r={...a,lastDifficulty:t};i(r),h(e,r)},setCurrentTier:t=>{let r={...a,lastTier:t};i(r),h(e,r)},updateCharacterOrder:(t,r)=>{let s={...a.characterProgress,characters:a.characterProgress.characters.map(e=>e.characterId===t?{...e,customIndex:r}:e)},l={...a,characterProgress:s};i(l),h(e,l)},updateCharacterOrders:t=>{let r=new Map(a.characterProgress.characters.map(e=>[e.characterId,e]));t.forEach(e=>{let{characterId:t,customIndex:a}=e,i=r.get(t);i&&(i.customIndex=a)});let s={...a.characterProgress,characters:Array.from(r.values())},l={...a,characterProgress:s};i(l),h(e,l)},updateLevelCompletion:(t,r,s)=>{let l={...a.characterProgress,characters:a.characterProgress.characters.map(e=>{if(e.characterId!==t)return e;let a=e.levelCompletions.findIndex(e=>e.levelId===r&&e.difficulty===s.difficulty);if(!(a>=0))return{...e,levelCompletions:[...e.levelCompletions,{levelId:r,difficulty:s.difficulty||"base",fastTier:s.fastTier||0}]};{let t=[...e.levelCompletions];return t[a]={...t[a],...s},{...e,levelCompletions:t}}})},o={...a,characterProgress:l};i(o),h(e,o)},getCharacterProgress:e=>a.characterProgress.characters.find(t=>t.characterId===e),getSortedCharacters:S,switchSaveSlot:e=>{e<1||e>3||(localStorage.setItem(s,e.toString()),t(e),i(g(e)),n())},getAllSaveSlots:()=>[1,2,3].map(e=>({slot:e,data:g(e)})),deleteSaveSlot:t=>{if(t<1||t>3)return;let a={characterProgress:c(),lastDifficulty:"base",lastTier:1,lastModified:Date.now(),name:"Save ".concat(t)};p(t,a),t===e&&(i(a),n())},resetAllProgress:()=>{let t={characterProgress:c(),lastDifficulty:"base",lastTier:1,lastModified:Date.now(),name:a.name||"Save ".concat(e)};i(t),h(e,t)}}}},9429:(e,t,a)=>{a.d(t,{Fd:()=>l,w:()=>s});let r=JSON.parse('[{"Type":"0","Name":"The Warrior","Slug":"char_default","FlavorDescription":"A wandering warrior.","GameplayDescription":"The default character, no special gameplay quirks.","StarterUpgrade":"hupg_bleed","Stats":{"kEndurance":6,"kStrength":7,"kLeadership":4,"kSpeed":3,"kDexterity":4,"kIntelligence":3},"Props":[],"WidgetOffset":"x: 5.00, y: 5.00","WidgetOverlaySize":"x: 77.00, y: 212.00","WidgetOverlayPos":"x: -3.50, y: 20.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"1","Name":"The Repentant","Slug":"char_recaller","FlavorDescription":"A sorrowful specimen, filled with regret.","GameplayDescription":"Balls deal 5% more damage each time they bounce. But, when they hit the back wall, they return to the player, damaging each enemy they pass through.","StarterUpgrade":"hupg_freeze","Stats":{"kEndurance":4,"kStrength":3,"kLeadership":6,"kSpeed":7,"kDexterity":4,"kIntelligence":5},"Props":["kBackRecall"],"WidgetOffset":"x: 8.00, y: 0.00","WidgetOverlaySize":"x: 81.00, y: 183.00","WidgetOverlayPos":"x: -6.50, y: 4.50","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"2","Name":"The Itchy Finger","Slug":"char_itchyfinger","FlavorDescription":"A disgraced deputy.","GameplayDescription":"Has scattered aim, but shoots twice as fast and constantly launches balls if any are available. Can move at full speed while shooting.","StarterUpgrade":"hupg_burn","Stats":{"kEndurance":4,"kStrength":2,"kLeadership":5,"kSpeed":3,"kDexterity":5,"kIntelligence":2},"Props":["kAlwaysShoot","kAimless"],"WidgetOffset":"x: 5.00, y: 0.00","WidgetOverlaySize":"x: 72.00, y: 188.00","WidgetOverlayPos":"x: -4.50, y: 6.50","WidgetXPSize":"x: 11.00, y: 97.00","WidgetXPPos":"x: 2.00, y: 57.00"},{"Type":"5","Name":"The Cogitator","Slug":"char_cogitator","FlavorDescription":"A brilliant philosopher, lost in thought.","GameplayDescription":"Automatically chooses upgrades.","StarterUpgrade":"hupg_laservert","Stats":{"kEndurance":5,"kStrength":5,"kLeadership":5,"kSpeed":5,"kDexterity":5,"kIntelligence":5},"Props":["kAutopickUpgrades"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 78.00, y: 188.00","WidgetOverlayPos":"x: -3.50, y: 3.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"6","Name":"The Tactician","Slug":"char_tactician","FlavorDescription":"A retired general, experienced beyond belief.","GameplayDescription":"Battles become turn-based.","StarterUpgrade":"hupg_heavy","Stats":{"kEndurance":5,"kStrength":5,"kLeadership":7,"kSpeed":0,"kDexterity":3,"kIntelligence":6},"Props":[],"WidgetOffset":"x: 3.00, y: 0.00","WidgetOverlaySize":"x: 79.00, y: 188.00","WidgetOverlayPos":"x: -4.50, y: 9.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"7","Name":"The Spendthrift","Slug":"char_spendthrift","FlavorDescription":"A wealthy merchant, living a life of extravagance.","GameplayDescription":"Shoots all balls at the same time in a wide arc.","StarterUpgrade":"hupg_vampire","Stats":{"kEndurance":7,"kStrength":8,"kLeadership":3,"kSpeed":6,"kDexterity":6,"kIntelligence":5},"Props":["kShotgun"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 79.00, y: 189.00","WidgetOverlayPos":"x: -6.50, y: 8.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"8","Name":"The Embedded","Slug":"char_embedded","FlavorDescription":"Marked by countless battles, he awaits his next assignment.","GameplayDescription":"Balls always pierce enemies until they hit a wall.","StarterUpgrade":"hupg_poison","Stats":{"kEndurance":3,"kStrength":4,"kLeadership":4,"kSpeed":4,"kDexterity":5,"kIntelligence":3},"Props":["kPierceUntilWall"],"WidgetOffset":"x: 5.00, y: 0.00","WidgetOverlaySize":"x: 83.00, y: 186.00","WidgetOverlayPos":"x: -4.50, y: 8.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"9","Name":"The Radical","Slug":"char_radicalai","FlavorDescription":"Radicalized by years of solitude.","GameplayDescription":"Plays the game and chooses upgrades automatically.","StarterUpgrade":"hupg_wind","Stats":{"kEndurance":5,"kStrength":5,"kLeadership":4,"kSpeed":6,"kDexterity":7,"kIntelligence":7},"Props":["kAI","kAutopickUpgrades"],"WidgetOffset":"x: 2.00, y: 0.00","WidgetOverlaySize":"x: 84.00, y: 188.00","WidgetOverlayPos":"x: -1.00, y: 8.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"10","Name":"The Empty Nester","Slug":"char_emptynester","FlavorDescription":"Finally, some peace and quiet.","GameplayDescription":"No baby balls. Each shot shoots multiple instances of one equipped special ball.","StarterUpgrade":"hupg_ghost","Stats":{"kEndurance":6,"kStrength":7,"kLeadership":3,"kSpeed":5,"kDexterity":5,"kIntelligence":6},"Props":["kMultiHero"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 81.00, y: 189.00","WidgetOverlayPos":"x: -2.50, y: 7.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"11","Name":"The Shade","Slug":"char_shade","FlavorDescription":"A killer for hire.","GameplayDescription":"Balls shoot from the back and have a base critical hit chance of 10%.","StarterUpgrade":"hupg_dark","Stats":{"kEndurance":3,"kStrength":4,"kLeadership":4,"kSpeed":3,"kDexterity":7,"kIntelligence":3},"Props":[],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 72.00, y: 190.00","WidgetOverlayPos":"x: -2.50, y: 8.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"12","Name":"The Cohabitants","Slug":"char_cohabitants","FlavorDescription":"A couple with many many children.","GameplayDescription":"For each ball launched, a copy is launched in the mirrored direction. Balls deal half damage.","StarterUpgrade":"hupg_broodmother","Stats":{"kEndurance":8,"kStrength":3,"kLeadership":6,"kSpeed":4,"kDexterity":3,"kIntelligence":4},"Props":["kMirror"],"WidgetOffset":"x: 3.00, y: 0.00","WidgetOverlaySize":"x: 77.00, y: 185.00","WidgetOverlayPos":"x: -5.50, y: 11.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"13","Name":"The Physicist","Slug":"char_physicist","FlavorDescription":"A pioneer of the field.","GameplayDescription":"Balls are affected by gravity pulling towards the back of the screen.","StarterUpgrade":"hupg_light","Stats":{"kEndurance":3,"kStrength":3,"kLeadership":4,"kSpeed":3,"kDexterity":4,"kIntelligence":8},"Props":["kGravity"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 77.00, y: 196.00","WidgetOverlayPos":"x: -2.00, y: 3.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"14","Name":"The Shieldbearer","Slug":"char_brickhead","FlavorDescription":"The front line\'s first defense.","GameplayDescription":"Holds a large shield that bounces back balls that hit it. Balls deal 100% more damage each time they bounce off the shield.","StarterUpgrade":"hupg_heavy","Stats":{"kEndurance":12,"kStrength":7,"kLeadership":4,"kSpeed":1,"kDexterity":2,"kIntelligence":3},"Props":["kBrickBreaker"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 75.00, y: 194.00","WidgetOverlayPos":"x: -4.50, y: 6.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"15","Name":"The Makeshift Sisyphus","Slug":"char_sisyphus","FlavorDescription":"A former king, tormented by time.","GameplayDescription":"Balls no longer deal direct hit damage, but AOE and status effect damage is increased by 4x. No baby balls.","StarterUpgrade":"hupg_earthquake","Stats":{"kEndurance":5,"kStrength":6,"kLeadership":3,"kSpeed":6,"kDexterity":5,"kIntelligence":4},"Props":["kNoBallDamage"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 66.00, y: 187.00","WidgetOverlayPos":"x: -2.00, y: 10.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"16","Name":"The Flagellant","Slug":"char_flagellant","FlavorDescription":"Just your average flagellant.","GameplayDescription":"Balls bounce normally off the bottom of the screen.","StarterUpgrade":"hupg_eggsac","Stats":{"kEndurance":8,"kStrength":5,"kLeadership":6,"kSpeed":3,"kDexterity":4,"kIntelligence":3},"Props":["kBackBallBounce"],"WidgetOffset":"x: 0.00, y: 0.00","WidgetOverlaySize":"x: 75.00, y: 189.00","WidgetOverlayPos":"x: -6.00, y: 6.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"17","Name":"The Juggler","Slug":"char_wimp","FlavorDescription":"A street performer, flourishes abound.","GameplayDescription":"Lobs balls into the air at a target position on the field. Balls don\'t start bouncing until they reach the ground.","StarterUpgrade":"hupg_lightning","Stats":{"kEndurance":6,"kStrength":7,"kLeadership":4,"kSpeed":3,"kDexterity":4,"kIntelligence":8},"Props":["kLobBalls"],"WidgetOffset":"x: 5.00, y: 0.00","WidgetOverlaySize":"x: 77.00, y: 186.00","WidgetOverlayPos":"x: -7.50, y: 11.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"},{"Type":"22","Name":"The False Messiah","Slug":"char_influencer","FlavorDescription":"A controversial leader with boundless charisma","GameplayDescription":"If streaming on Twitch, audience can vote on certain choices and random events.","StarterUpgrade":"hupg_bleed","Stats":{"kEndurance":5,"kStrength":5,"kLeadership":5,"kSpeed":5,"kDexterity":5,"kIntelligence":5},"Props":[],"WidgetOffset":"x: 5.00, y: 5.00","WidgetOverlaySize":"x: 75.00, y: 190.00","WidgetOverlayPos":"x: -4.50, y: -4.00","WidgetXPSize":"x: 11.00, y: 113.00","WidgetXPPos":"x: 2.00, y: 44.00"}]');function i(e){return{id:e.Slug,type:e.Type,name:e.Name,slug:e.Slug,flavorDescription:e.FlavorDescription,gameplayDescription:e.GameplayDescription,starterBall:e.StarterUpgrade,stats:e.Stats,props:e.Props}}function s(){return r.filter(e=>"???"!==e.Name&&"char_influencer"!==e.Slug).map(i).sort((e,t)=>parseInt(e.type)-parseInt(t.type))}function l(e){return e.replace(/^k/,"")}}}]);